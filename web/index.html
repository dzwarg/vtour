<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>vTour</title>

  <!-- ExtJS scripts -->
  <link rel="stylesheet" type="text/css" href="ext-2.0.2/resources/css/ext-all.css" />
  <link rel="stylesheet" type="text/css" href="ext-2.0.2/resources/css/xtheme-gray.css" />
  <script type="text/javascript" src="ext-2.0.2/adapter/ext/ext-base.js"></script>
  <script type="text/javascript" src="ext-2.0.2/ext-all.js"></script>
  <script type="text/javascript" src="FlickrPagingToolbar.js"></script>
  <script type="text/javascript">
    var vtour = {};
    vtour.flickrkey='FLICKR-KEY';

    Ext.onReady(function(){

      var state = new Ext.state.CookieProvider();
      Ext.state.Manager.setProvider( state );
      
      var welcomeTemplate = new Ext.Template( 'Welcome, {0}' );

      var loggedInPanel = new Ext.FormPanel({
        title:'My Account',
        collapsed: false,
        items: [
          new Ext.Panel({
            id: 'welcomePanel',
            border:false,
            html: '',
            style: 'margin:0px 0px 5px 0px; padding: 2px;'
          })
        ]
      });
      
      var loginPanel = new Ext.FormPanel({
        title:'Sign In',
        collapsed: false,
        defaultType: 'textfield',
        labelWidth: 63,
        labelAlign: 'right',
        items: [
          new Ext.Panel({
            border: false,
            html: 'Sign in, or register to start saving your tours.',
            style: 'margin:0px 0px 5px 0px; padding: 2px;'
          }),
          {
            fieldLabel: 'Login',
            name: 'user',
            width: 125,
            vtype: 'alphanum',
            allowBlank: false
          }, {
            inputType:'password',
            fieldLabel: 'Password',
            name: 'password',
            width: 125,
            allowBlank: false
          }
        ],
        method: 'GET',
        url: '/~davidz/users/login'
      });

      loginPanel.addButton({
        text: 'Sign In',
        handler: function() {
          var frm = loginPanel.getForm();
          if ( frm.isValid() ) {
            frm.submit({
              waitMsg:'Logging in...',
              failure: function( form, action ) {
                if ( action.result.message != 'ok' ) {
                  Ext.MessageBox.alert( 'Oops!', action.result.message );
                  return;
                }
                
                loginPanel.hide();
                loginPanel.getForm().reset();
                loggedInPanel.show();
                
                // save auth cookie
                state.set( 'vtour_secret', action.result.secret );
                state.set( 'vtour_user', action.result.user.login );
                
                Ext.get('welcomePanel').update( welcomeTemplate.apply( [action.result.user.login] ) );
              }
            });
          }
        }
      });
      
      var registerWin;

      loginPanel.addButton({
        text: 'Register',
        handler: function() {
          if ( !registerWin ) {
            var registerForm = new Ext.FormPanel({
              border: false,
              collapsible: false,
              bodyStyle:'padding:2px 2px 2px 2px;',
              method:'POST',
              url:'/~davidz/users/register',
              items: [
                new Ext.form.FieldSet({
                  title: 'Pick a login',
                  labelAlign: 'right',
                  labelWidth: 63,
                  height: 53,
                  defaultType: 'textfield',
                  items: [{
                    fieldLabel: 'Login', 
                    name: 'user', 
                    width: 125,
                    vtype: 'alphanum',
                    allowBlank: false                    
                  }]
                }),
                new Ext.form.FieldSet({
                  title: 'Pick a good password',
                  labelAlign: 'right',
                  labelWidth: 63,
                  height: 80,
                  defaultType: 'textfield',
                  items:[{ 
                    fieldLabel: 'Password', 
                    name: 'password', 
                    width: 125,
                    inputType: 'password',
                    allowBlank: false
                  },{ 
                    fieldLabel: 'Verify', 
                    name: 'password2', 
                    width: 125,
                    inputType: 'password',
                    allowBlank: false
                  }]
                }),
                new Ext.form.FieldSet({
                  title: 'Finally, your email address',
                  labelAlign: 'right',
                  labelWidth: 63,
                  height: 80,
                  defaultType: 'textfield',
                  items: [{
                    fieldLabel: 'Email', 
                    name: 'email', 
                    width: 125,
                    vtype: 'email',
                    allowBlank: false
                  },{ 
                    fieldLabel: 'Verify', 
                    name: 'email2', 
                    width: 125,
                    vtype: 'email',
                    allowBlank: false
                  }]
                })
              ]
            });
            
            registerWin = new Ext.Window({
              title: 'Register an account',
              modal: true,
              closeAction: 'hide',
              items:[
                registerForm
              ],
              buttons: [
                new Ext.Button({ 
                  text: 'Register',
                  handler: function() {
                    var frm = registerForm.getForm();
                    if ( frm.findField('password').el.getValue() != frm.findField('password2').el.getValue() ) {
                      frm.markInvalid([{
                        id: 'password',
                        msg: 'Passwords must match.'
                      },{
                        id: 'password2',
                        msg: 'Passwords must match.'
                      }]);
                      return;
                    }
                    if (frm.findField('email').el.getValue() != frm.findField('email2').el.getValue() ) {
                      frm.markInvalid([{
                        id: 'email',
                        msg: 'Email addresses must match.'
                      },{
                        id: 'email2',
                        msg: 'Email addresses must match.'
                      }]);
                      return;                      
                    }
                    if ( frm.isValid() ) {
                      frm.submit({
                        waitMsg:'Registering...',
                        failure: function( form, action ) {
                          if ( action.result.message != 'ok' ) {
                            if ( action.result.message == 'A user with that name already exists.' ) {
                              registerForm.getForm().markInvalid( [{
                                id:'user',
                                msg: action.result.message
                              }] );
                            }
                            else
                              Ext.MessageBox.alert( 'Oops!', action.result.message );
                          }
                          else {
                            registerForm.getForm().reset();
                            registerWin.hide();
                          }
                        }
                      });
                    }
                  }
                }),
                new Ext.Button({
                  text: 'Cancel',
                  handler: function() {
                    registerForm.getForm().reset();
                    registerWin.hide();
                  }
                })
              ]
            });
          }

          registerWin.show();
        }
      });

      loggedInPanel.addButton({
        text: 'Sign Out',
        handler: function() {
          // clear cookies
          state.clear( 'vtour_secret' );
          state.clear( 'vtour_user' );
                        
          loggedInPanel.hide();
          loginPanel.show();
        }
      });

      vtour.datePanel = new Ext.form.FormPanel({
        formId: 'dateRangeFrm',
        collapsed: true,
        title: 'Date Range',
        labelWidth: 63,
        labelAlign: 'right',
        defaultType: 'datefield',
        bodyStyle: 'margin:0px;padding:2px;',
        items: [{
          name: 'fromDate',
          allowBlank: false,
          width: 60,
          fieldLabel: 'From',
          value: '01/01/08',
          maxValue: new Date(),
          minValue: (function(){
            var d = new Date();
            d.setFullYear( d.getFullYear()-1 );
            return d;
          })()
        },{
          name: 'toDate',
          allowBlank: false,
          width: 60,
          fieldLabel: 'To',
          value: '09/17/08',
          maxValue: new Date(),
          minValue: (function(){
            var d = new Date();
            d.setFullYear( d.getFullYear()-1 );
            return d;
          })()
        }]
      });

      vtour.tagPanel = new Ext.form.FormPanel({
	formId: 'tagForm',
	collapsed: true,
	title: 'Tag Filter',
	labelWidth: 63,
	labelAlign: 'right',
	defaultType: 'textfield',
	bodyStyle: 'margin:0px;padding:2px;',
	items:[{
	  name: 'tagFilter',
	  allowBlank: true,
	  width: 125,
	  fieldLabel: 'Tags'
	}]
      });
      
      var eastPanel = new Ext.Panel({
        region:'east',
        id:'eastPanel',
        width:200,
        defaults: {
          // applied to each contained panel
          collapsible:true,
          border:false
        },
        items:[
          { title:'Map Layers',
            contentEl:'mapLayerSwitcherPanel',
            collapsed: false,
            bodyStyle: 'margin:0px;' },
          loginPanel,
          loggedInPanel,
          {
            title:'Search Distance',
            contentEl:'searchPanel',
            collapsed: true,
            bodyStyle: 'margin:0px;'
          },
          vtour.datePanel,
	  vtour.tagPanel
        ]
      });
      
      vtour.results = new Ext.TabPanel({
        id:'resultTabs',
        visible: false,
        height: 170,
        border: false,
        activeTab: 0,
        enableTabScroll: true,
        defaults: { 
          autoScroll: true, 
          closable: true
        },
        items: [ { 
          title: 'Instructions', 
          contentEl: 'south',
          closable: false
        } ],
        listeners: {
          'beforeremove': function( me, child ){
            var i = me.items.findIndex( 'id', child.id );
            if( i > 0 ) {
              vtour.ol_layers['features'].removeFeatures(
                vtour.ol_layers['features'].features.slice( i-1, i )
              );
              
              for ( var j = vtour.ol_layers['markers'].features.length - 1; j >= 0; j-- ) {
                var feature = vtour.ol_layers['markers'].features[j];
                if ( feature.searchId == child.id ) {
                  vtour.ol_layers['markers'].removeFeatures( [feature] );
                }
              }
            }
          }
        }
      });

      // setup the viewport
      var viewport = new Ext.Viewport({
        layout:'border',
        items:[{
          region:'center',
          deferredRender:false,
          contentEl:'center',
          margins:'0 0 0 0',
          border: false
        },
        eastPanel,{
          region:'south',
          id:'searchPanelDiv',
          collapsible:false,
          split:false,
          height:170,
          margins:'0 0 0 0',
          border: false,
          items:[
            vtour.results
          ]
        }]
      });
      
      // hide the logged-in status until after logging in
      if ( state.get( 'vtour_user', '' ) == '' ) {
        loggedInPanel.hide();
      }
      else {
        loginPanel.hide();
      }

      viewport.on( {
        'resize': function( obj, adjWidth, adjHeight, rawWidth, rawHeight ){ 
          if ( ol_resize ) {
            ol_resize();
          }
        }
      });
      
      // create the script tag proxy for loading the results.  all flickr photo
      // searches will use this same proxy object
      vtour.pxy = new Ext.data.ScriptTagProxy({
        callbackParam: 'jsoncallback',
        url: 'http://api.flickr.com/services/rest/'
      });
      
      vtour.photoReader = new Ext.data.JsonReader(
        {
          successProperty: 'stat',
          totalProperty: 'photos.total',
          root: 'photos.photo',
          id: 'id'
        }, 
        Ext.data.Record.create([
          {name: 'id'},
          {name: 'owner'},
          {name: 'secret'},
          {name: 'server'},
          {name: 'farm'},
          {name: 'title'},
          {name: 'ispublic'},
          {name: 'isfriend'},
          {name: 'isfamily'},
          {name: 'latitude', type: 'float'},
          {name: 'longitude', type: 'float'},
          {name: 'accuracy', type: 'int'},
          {name: 'place_id'},
          {name: 'woeid', type: 'int'},
          {name: 'tags'}
        ])
      );
      
      vtour.searchTpl = new Ext.XTemplate( 
        '<tpl for=".">',
        '<div class="thumb-wrap" id="{title}">',
		    '<div class="thumb" ext:position="{longitude},{latitude}" ',
		    'ext:tags="{tags}" ext:image="{imageurl}" ext:title="{title}" ',
		    'ext:imageid="{id}" ext:owner="{owner}">',
		    '<img src="{thumburl}" title="{title}"></div>',
		    '<span class="x-editable">{title}</span></div>',
        '</tpl>',
        '<div class="x-clear"></div>'
      );

      setTimeout( ol_init, 1 );
    });
    
    vtour.getFlickrPhotos = function( bbox ) {    
      var frm = vtour.datePanel.getForm();
      var fromDate = frm.findField( 'fromDate' ).getValue();
      var toDate = frm.findField( 'toDate' ).getValue();
      frm = vtour.tagPanel.getForm();
      var tags = frm.findField( 'tagFilter' ).getValue();

      var store = new Ext.data.Store({
        proxy: vtour.pxy,
        reader: vtour.photoReader,
        baseParams: {
          method: 'flickr.photos.search',
          format: 'json',
          api_key: vtour.flickrkey,
          bbox: bbox,
          min_taken_date: fromDate.format('Y-m-d'),
          max_taken_date: toDate.format('Y-m-d'),
          extras:'geo,tags',
	  tags: tags
        }
      });
      
      store.load({ params:
        {
          page: 1,
          per_page: 10      
        }
      });
      
      var oneSearchPanel = new Ext.Panel({
        cls:'images-view',
        width:535,
        layout:'fit',
        title:'Search '+(vtour.results.items.length),

        items: new Ext.DataView({
          store: store,
          tpl: vtour.searchTpl,
          autoHeight:true,
          multiSelect: true,
          overClass:'x-view-over',
          itemSelector:'div.thumb-wrap',
          emptyText: '',
      
          prepareData: function(data){
            data.thumburl = 'http://farm' + data.farm + '.static.flickr.com/' + data.server + 
              '/' + data.id + '_' + data.secret + '_s.jpg';
            data.imageurl = 'http://farm' + data.farm + '.static.flickr.com/' + data.server + 
              '/' + data.id + '_' + data.secret + '_m.jpg';
            return data;
          }
        }),

        bbar: new Ext.FlickrPagingToolbar({
	  pageSize: 10,
	  store: store,
	  displayInfo: true,
	  displayMsg: 'Displaying images {0} - {1} of {2}',
	  emptyMsg: 'No images to display'
        }),        
        
        listeners: {
          // this activate function is eye candy
          'activate': function(p) {
            var layer = vtour.ol_layers['features'];
            var index = vtour.results.items.findIndex( 'id', p.id );
            var feature = (layer.features.slice( index-1, index ))[0];
            new OpenLayers.Tween().start( 
              { t: 255 }, 
              { t: 0 }, 
              50, 
              {
                callbacks: {
                  eachStep: function( val ){ 
                    feature.style.fillOpacity = 0.2 + (val['t'] / 255) * 0.8; 
                    layer.redraw();
                  }
                }
              }
            ); // end tween.start
          }
        }
      }); // end ext.panel
      
      Ext.fly(vtour.results.el.id).on( 'click',function( e ) {
        e.stopEvent();
        var target = e.getTarget('div.thumb');
        if ( target ) {
          var detail = {
            tags: target.getAttributeNS( '', 'ext:tags' ),
            position: {
              lon: parseFloat(target.getAttributeNS( '', 'ext:position' ).split(',')[0]),
              lat: parseFloat(target.getAttributeNS( '', 'ext:position' ).split(',')[1])
            },
            image: (function(img){
	      var i = new Image();
	      i.src = img;
	      return i;
	    })(target.getAttributeNS( '', 'ext:image' ) ),
            title: target.getAttributeNS( '', 'ext:title' ),
	    imageid: target.getAttributeNS( '', 'ext:imageid' ),
	    owner: target.getAttributeNS( '', 'ext:owner' )
          }
          
          showDetail( detail );
        }
      }); 
              
      // show results
      vtour.results.add( oneSearchPanel ).show();      
    }
	</script>
  <style type="text/css">
    html,body,div {
      font-family: "Arial,Helvetica,sans-serif"
    }
    div#mapLayerSwitcherPanel {
      padding:2px;
    }
    div#searchControl {
      padding:2px;
    }
    div#south {
      padding-top: 1.4em;
      text-align: center;
      font-size: 2em;
      color: #999999;
    }
    
    /** paging toolbar and dataview **/
    .images-view .x-panel-body{
    	background: white;
    	font: 11px Arial, Helvetica, sans-serif;
    }
    .images-view .thumb{
    	background: #dddddd;
    	padding: 3px;
    }
    .images-view .thumb img{
    	height: 75px;
    	width: 75px;
    }
    .images-view .thumb-wrap{
    	float: left;
    	margin: 4px;
    	margin-right: 0;
    	padding: 2px;
    	width: 81px;
    	overflow: hidden;
    }
    .images-view .thumb-wrap span{
    	display: block;
    	overflow: hidden;
    	text-align: center;
    	white-space: nowrap;
    }

    .images-view .x-view-over{
	border:1px solid #dddddd;
	padding: 1px;
    }

    .images-view .x-view-selected{
    	border:1px solid #99bbe8;
    	padding: 1px;
    }
    .images-view .x-view-selected .thumb{
    	background:transparent;
    }

    .images-view .loading-indicator {
    	font-size:11px;
    	background-image:url('../../resources/images/default/grid/loading.gif');
    	background-repeat: no-repeat;
    	background-position: left;
    	padding-left:20px;
    	margin:10px;
    }
    /* Fix for Firefox 3 */
    .x-date-middle {
      width: 160px;
    }
    .x-grid3 table {
      table-layout:fixed;
    }
  </style>
<!-- end ExtJS scripts -->

<!-- OpenLayers scripts -->
  <script type="text/javascript" src="OpenLayers-2.7/OpenLayers.js"></script>
  <script type="text/javascript" src="OpenLayers-2.6/lib/Proj4js/proj4js.js"></script>
  <script type="text/javascript" src="http://api.maps.yahoo.com/ajaxymap?v=3.7&appid=APP-ID"></script>
  <script type="text/javascript" src="http://maps.google.com/maps?file=api&v=2.82&key=GMAP-KEY"></script>
  <script type="text/javascript">
    function ol_init(){
      Proj4js.libPath = 'OpenLayers-2.6/lib/Proj4js/';
      var options = {
        projection: new OpenLayers.Projection('EPSG:900913'),
        displayProjection: new OpenLayers.Projection('EPSG:4326'),
        units: 'm',
        maxResolution: 156543.0339,
        maxExtent: new OpenLayers.Bounds( -20037508, -20037508, 20037508, 20037508.34 )
      };

      vtour.boxWidth = 20;
      vtour.ol_map = new OpenLayers.Map('mapDiv', options);

      vtour.ol_map.addControl(new OpenLayers.Control.KeyboardDefaults());

      vtour.ol_layers = {
        yahoo: new OpenLayers.Layer.Yahoo( "Yahoo", { sphericalMercator: true } ),
        google: new OpenLayers.Layer.Google( "Google", { sphericalMercator: true } ),
        features: new OpenLayers.Layer.Vector('Bounding Boxes'),
        markers: new OpenLayers.Layer.Vector(
          "Marker Drop Shadows",
          {
            styleMap: new OpenLayers.StyleMap({
              default: {
                // Set the external graphic and background graphic images.
                externalGraphic: "OpenLayers-2.6/img/marker-gold.png",
                backgroundGraphic: "OpenLayers-2.6/img/marker_shadow.png",
                
                // Makes sure the background graphic is placed correctly relative
                // to the external graphic.
                backgroundXOffset: 0,
                backgroundYOffset: -7,
                
                // Set the z-indexes of both graphics to make sure the background
                // graphics stay in the background (shadows on top of markers looks
                // odd; let us not do that).
                graphicZIndex: 101,
                backgroundGraphicZIndex: 100,
                
                pointRadius: 10
              },
              select: {
                externalGraphic: "OpenLayers-2.6/img/marker-green.png",
                pointRadius: 10
              }
            }),
            isBaseLayer: false,
            rendererOptions: {yOrdering: true}
          }
        )
      };

      //
      // select photo items
      //
      selectControl = new OpenLayers.Control.SelectFeature(
        vtour.ol_layers['markers'],
        {
          onSelect: function (feature) {
	    // feature has a property 'searchDetail' that contains:
	    // title, position, tags, image
            var popup = new OpenLayers.Popup.FramedCloud(
              "photo", 
              feature.geometry.getBounds().getCenterLonLat(),
              null,
              '<div style="width:' + (feature.searchDetail.image.width+6) + 'px;" class="detail">' +
		'<h2 class="detail">' + feature.searchDetail.title +  '</h2>' +
		'<img src="' + feature.searchDetail.image.src + '" alt="' + feature.searchDetail.title +
		'" title="' + feature.searchDetail.title + '" width="' + feature.searchDetail.image.width +
		'" height="' + feature.searchDetail.height + '" class="detail"/>' +
		'<div class="detaillink"><a href="http://www.flickr.com/photos/' + feature.searchDetail.owner + '/' + 
		feature.searchDetail.imageid + '" target="_blank" class="detail">photopage</a></div>' +
		'<p class="detail"><span class="detail">tags</span>:' + feature.searchDetail.tags + '</p>' +
		'</div>',
              null, 
              true, 
              function (evt) {
                OpenLayers.Event.stop(evt);
                selectControl.unselect(feature);
              }
            );
              
            feature.popup = popup;
            vtour.ol_map.addPopup(popup);
          }, 
          onUnselect: function (feature) {
            vtour.ol_map.removePopup(feature.popup);
            feature.popup.destroy();
            feature.popup = null;
          }
        }
      );
      
      vtour.ol_map.addControl(selectControl);
      selectControl.activate();
      //
      // end of select photo items
      //

      for ( var key in vtour.ol_layers )
      {
        vtour.ol_map.addLayer( vtour.ol_layers[key] );
      }

      vtour.ol_map.setCenter(new OpenLayers.LonLat(-8367155.413500762,4859078.000840925), 12);

      vtour.ol_map.events.register('click', vtour.ol_map, focusRegion );
    }

    function ol_resize() {
      vtour.ol_map.updateSize();
    }

    function changeLayer( element ) {
      vtour.ol_map.setBaseLayer( vtour.ol_layers[ element.value ] );
    }

    function changeRadius( element ) {
      vtour.boxWidth = element.value * 2;
    }

    function focusRegion(e) {
      var lonlat = vtour.ol_map.getLonLatFromPixel(e.xy);
      var bounds = vtour.ol_map.getExtent();

      var sz = Math.min( bounds.getWidth(), bounds.getHeight() ) / vtour.boxWidth;

      var pointList = [];
      pointList.push( new OpenLayers.Geometry.Point( lonlat.lon - sz, lonlat.lat - sz ) );
      pointList.push( new OpenLayers.Geometry.Point( lonlat.lon - sz, lonlat.lat + sz ) );
      pointList.push( new OpenLayers.Geometry.Point( lonlat.lon + sz, lonlat.lat + sz ) );
      pointList.push( new OpenLayers.Geometry.Point( lonlat.lon + sz, lonlat.lat - sz ) );
      pointList.push( pointList[0] );
      
      var linearRing = new OpenLayers.Geometry.LinearRing( pointList );
      var polygonFeature = new OpenLayers.Feature.Vector(
        new OpenLayers.Geometry.Polygon([linearRing]), null, {
          fillColor: '#fff',
          fillOpacity: 0.2,
          strokeColor: '#333',
          strokeOpacity: 0.5,
          strokeWidth: 1,
          strokeLinecap: 'round'
        });

      vtour.ol_layers['features'].addFeatures([polygonFeature]);

      var ptMin = Proj4js.transform( 
        vtour.ol_map.projection.proj, 
        vtour.ol_map.displayProjection.proj, 
        { x: lonlat.lon - sz, y: lonlat.lat - sz } );
      var ptMax = Proj4js.transform(
        vtour.ol_map.projection.proj,
        vtour.ol_map.displayProjection.proj,
        { x: lonlat.lon + sz, y: lonlat.lat + sz } );
      
      var bbox = ptMin.x.toString() + ',' + ptMin.y.toString() + ',' +
        ptMax.x.toString() + ',' + ptMax.y.toString();
        
      vtour.getFlickrPhotos( bbox );
    }
    
    function showDetail( detail ) {
      // put something on the map
      
      // reproject from 4326
      var pt = Proj4js.transform( 
        vtour.ol_map.displayProjection.proj, 
        vtour.ol_map.projection.proj, 
        { x: detail.position.lon, y: detail.position.lat } );
      
      // create a feature array of 1 item
      var feature = new OpenLayers.Feature.Vector(
        new OpenLayers.Geometry.Point(pt.x, pt.y)
      );
      
      feature.searchId = vtour.results.activeTab.el.id;
      feature.searchDetail = detail;
      
      // attach to the feature layer
      vtour.ol_layers['markers'].addFeatures( [feature] );
    }
  </script>
  <style type="text/css">
    div#mapDiv {
      height:100%;
      width:100%;
    }
    div.detail {
      padding: 5px;
    }
    h2.detail {
    }
    p.detail {
      color:#666666;
      font-size:0.75em;
      padding:2px;
    }
    img.detail {
    }
    span.detail {
      font-weight:bold;
    }
    div.detaillink {
      text-align:right;
    }
    a.detail {
      font-size:0.7em;
    }
  </style>
<!-- end OpenLayers scripts -->
</head>
<body>
  <div id="center">
    <div id="mapDiv">
    </div>
  </div>
  <div id="mapLayerSwitcherPanel" class="x-hidden">
    <ul>
      <li><input type="radio" name="olLayerName" value="yahoo" onclick="changeLayer(this);" checked="checked"/>Yahoo</li>
      <li><input type="radio" name="olLayerName" value="google" onclick="changeLayer(this);"/>Google</li>
    </ul>
  </div>
  <div id="searchPanel" class="x-hidden" style="padding:2px;">
    <ul>
      <li>
        <input type="radio" name="searchRadius" value="20" onclick="changeRadius(this);" id="sr1" />
        <label for="sr1">Small</label>
      </li>
      <li>
        <input type="radio" name="searchRadius" value="10" checked="checked" onclick="changeRadius(this);" id="sr2"/>
        <label for="sr2">Medium</label>
      </li>
      <li>
        <input type="radio" name="searchRadius" value="5" onclick="changeRadius(this);" id="sr3" /> 
        <label for="sr3">Large</label>
      </li>
    </ul>
  </div>
  <div id="datePanel" class="x-hidden" style="padding:2px;"></div>
  <div id="south">
    <p>Click on the map to search for photos.</p>
  </div>
 </body>
</html>
